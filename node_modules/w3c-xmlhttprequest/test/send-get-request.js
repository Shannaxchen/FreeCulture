(function() {
  'use strict';

  var XMLHttpRequest = require('../lib/xmlhttprequest');

  function main() {
    var args = process.argv;
    var uri = args[args.length - 1];
    var req = new XMLHttpRequest();
    req.open('GET', uri);
    req.responseType = 'text';
    req.addEventListener('readystatechange', function() {
      console.log('Change ready state to %s.', req.readyState);
    }, false);
    req.upload.addEventListener('load', function() {
      console.log('Upload finish.');
    }, false);
    req.addEventListener('load', function() {
      console.log(req.getAllResponseHeaders());
      console.log(req.response);
    }, false);
    req.send(null);
  }

  if (require.main === module) {
    main();
  }
})();
